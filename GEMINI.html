<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Gemini ç”¢å“èªªæ˜æ›¸ç¨½æ ¸å™¨</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; max-width: 800px; margin: 40px auto; padding: 0 20px; color: #333; }
        .controls { background: #fff; border: 1px solid #e0e0e0; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h2 { color: #1a73e8; }
        textarea, input[type="password"] { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; margin-bottom: 15px; }
        #output { white-space: pre-wrap; background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 5px solid #1a73e8; margin-top: 20px; min-height: 100px; }
        button { background: #1a73e8; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px; }
        button:disabled { background: #ccc; }
    </style>
</head>
<body>
    <h2>ğŸ“ Gemini æ–‡ä»¶æ¯”å°åŠ©æ‰‹</h2>
    <div class="controls">
        <label><b>1. API Key:</b></label>
        <input type="password" id="apiKey" placeholder="åœ¨æ­¤è¼¸å…¥æ‚¨çš„ Gemini API Key">
        
        <label><b>2. é¸æ“‡ç”¢å“èªªæ˜æ›¸ (PDF):</b></label><br>
        <input type="file" id="fileInput" accept="application/pdf"><br><br>
        
        <label><b>3. åˆ†ææŒ‡ä»¤ (Prompt):</b></label>
        <textarea id="promptInput">é€™æ˜¯ä¸€ä»½çµæ§‹å‹å•†å“çš„ç”¢å“èªªæ˜æ›¸ï¼Œè«‹å¹«æˆ‘è©³ç´°åˆ—å‡ºå®ƒçš„ï¼š
1. ä¸‹é™åƒ¹æ ¼è§€å¯Ÿé »ç‡èˆ‡å…·é«”è§€å¯Ÿå€é–“ï¼ˆæ—¥æœŸï¼‰
2. æå‰å‡ºå ´çš„é »ç‡èˆ‡å…·é«”è§€å¯Ÿå€é–“ï¼ˆæ—¥æœŸï¼‰
3. é€£çµæ¨™çš„åç¨±</textarea>
        
        <button id="btn">é–‹å§‹åˆ†ææ–‡ä»¶</button>
    </div>

    <h3>åˆ†æçµæœï¼š</h3>
    <div id="output">å°šæœªé–‹å§‹åˆ†æ...</div>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        // ç›´æ¥ç”¨äº‹ä»¶ç›£è½ï¼Œé¿é–‹ window ç¶å®šå•é¡Œ
        document.getElementById('btn').addEventListener('click', async () => {
            const API_KEY = document.getElementById("apiKey").value;
            const fileInput = document.getElementById("fileInput");
            const output = document.getElementById("output");
            const btn = document.getElementById("btn");

            if (!API_KEY) return alert("è«‹è¼¸å…¥ API Key");
            if (fileInput.files.length === 0) return alert("è«‹é¸æ“‡æª”æ¡ˆ");

            btn.disabled = true;
            output.innerText = "ğŸš€ æ­£åœ¨å‚³è¼¸è³‡æ–™çµ¦ AIï¼Œè«‹ç¨å€™...";

            try {
                const genAI = new GoogleGenerativeAI(API_KEY);
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

                const file = fileInput.files[0];
                const base64Data = await new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onloadend = () => resolve(reader.result.split(',')[1]);
                    reader.readAsDataURL(file);
                });

                // ä¿®æ”¹å¾Œçš„å‘¼å«æ–¹å¼ï¼Œæ›´ç©©å®š
                const contents = [
                    {
                        inlineData: {
                            data: base64Data,
                            mimeType: "application/pdf"
                        }
                    },
                    { text: document.getElementById("promptInput").value }
                ];

                const result = await model.generateContent(contents);
                const response = await result.response;
                output.innerText = response.text();

            } catch (error) {
                console.error(error);
                output.innerHTML = `<span style="color:red">âŒ ç™¼ç”ŸéŒ¯èª¤ï¼š${error.message}</span><br><small>è«‹æª¢æŸ¥ API Key æ˜¯å¦æ­£ç¢ºæˆ–æ˜¯å¦æ­£åœ¨ä½¿ç”¨ VPN/å…¬å¸ç¶²è·¯ã€‚</small>`;
            } finally {
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>
