<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
    <title>保本 Twinwin</title>

    <!-- 引入 Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<title>Fixed Coupon Note (FCN)</title>
<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"> <style>
/* ===================== Body ===================== */ body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg,#f0f2f8,#e8f0ff);
    padding: 40px;
    color: #333;
    margin: 0;
}
.section-wrapper {
    position: relative; 
}

.back-btn {
    position: absolute;
    left: 20px;   /* 越大越往右 */
    top: 0px;     /* 越大越往下 */

    background: #ffffff;
    color: #004c91;
    border: 2px solid #1f72c6;
    padding: 7px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    transition: 0.3s;
}

.back-btn:hover {
    background: #e6f0ff;
}


/* ===================== Container ===================== */ .container {
    background: #fff;
    border-radius: 16px;
    padding: 40px 50px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.08);
    max-width: 950px;
    margin: auto;
    transition: box-shadow 0.3s, transform 0.3s; } .container:hover {
    box-shadow: 0 12px 40px rgba(0,0,0,0.12);
    /*transform: translateY(-3px);*/
}
h2 {
    color: #0f4aa3;
    text-align: center;
    margin-bottom: 30px;
    font-size: 38px;
}
h3 {
    color: #333;
    margin-top: 50px;
    font-size: 28px;
    border-bottom: 2px solid #0077cc;
    padding-bottom: 6px;
}
h4 { color: #333; margin-top: 25px; font-size: 20px; } p { line-height: 1.8; font-size: 16px; }

/* ===================== Divider ===================== */ .divider { 
    height: 1px; 
    background: #e1e4e8; 
    margin: 40px 0; 
    border-radius: 1px;
}

/* ===================== Table ===================== */ table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    margin-top: 15px;
    margin-bottom: 25px;
    font-size: 16px;
}
table th, table td {
    padding: 12px 15px;
    text-align: left;
}
table th {
    background: linear-gradient(135deg,#c7ddff,#e3f0ff);
    color: #003e6b;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
}
table td {
    background-color: #fafafa;
    border-bottom: 1px solid #e1e4e8;
}
table tr:hover td {
    background-color: #eaf1ff;
}

/* ===================== Tooltip ===================== */ .tooltip {
    position: relative;
    cursor: help;
    font-weight: 600;
    color: #0077cc;
}
.tooltip .tooltiptext {
    visibility: hidden;
    width: 160px;
    background: linear-gradient(135deg, #ffffff, #e6f0ff);
    color: #333;
    text-align: center;
    padding: 8px 12px;
    border-radius: 12px;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    margin-left: -80px;
    opacity: 0;
    box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    transition: opacity 0.3s;
    font-size: 13px;
}
.tooltip .tooltiptext::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #e6f0ff transparent transparent transparent; } .tooltip:hover .tooltiptext { 
    visibility: visible; 
    opacity: 1;
}

/* ===================== Features ===================== */ .features {
    display: flex;
    justify-content: space-between;
    align-items: stretch;
    flex-wrap: nowrap;         /* 強制單行排列 */
    gap: 12px;
}


.feature-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    flex: 0 0 30%;          /* 三等分 */
    max-width: 33.33%;
    box-sizing: border-box;
    padding: 25px 15px;
    border-radius: 16px;
    background: linear-gradient(145deg,#f9fafc,#e6f0ff);
    transition: transform 0.3s, box-shadow 0.3s; } .features.faq .feature-item:hover {
    transform: none; /* 取消 hover 移動，避免動畫干擾 */
    box-shadow: 0 10px 25px rgba(0,0,0,0.15); /* 保留陰影美感 */ } .feature-circle {
    width: 70px;
    height: 70px;
    color: white;
    font-weight: bold;
    font-size: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1); } .feature-text { font-size: 16px; line-height: 1.5; }
.feature1 { background: linear-gradient(135deg,#0077cc,#005999); }
.feature2 { background: linear-gradient(135deg,#00a99d,#007a6e); }
.feature3 { background: linear-gradient(135deg,#ff8c42,#d65a00); }

/* ===================== Scenario Cards ===================== */ .scenario-cards { display: flex; flex-wrap: wrap; gap: 20px; margin-top: 25px; } .scenario {
    flex: 1 1 45%;
    border-radius: 16px;
    padding: 25px 20px;
    box-shadow: 0 6px 16px rgba(0,0,0,0.08);
    transition: transform 0.3s, box-shadow 0.3s; } .scenario:hover { 
    transform: translateY(-5px); 
    box-shadow: 0 10px 28px rgba(0,0,0,0.15); } .scenario-title { font-weight: 600; font-size: 18px; margin-bottom: 12px; } .scenario-desc { margin-bottom: 8px; font-size: 15px; }

/* Scenario gradient colors */
.scenarioA { background: linear-gradient(135deg,#fffefa,#fff3cc); color: #403200; } .scenarioB { background: linear-gradient(135deg,#faf5ff,#e7dcff); color: #310278; } .scenarioC { background: linear-gradient(135deg,#f2fcf7,#deffef); color: #007352; } .scenarioD { background: linear-gradient(135deg,#fff2f2,#ffdede); color: #690000; }

/* ===================== Images ===================== */ .scenario-image { text-align: center; margin-top: 30px; } .payoff-img { display: inline-block; max-width: 100%; height: auto; border-radius: 12px; cursor: pointer; box-shadow: 0 4px 16px rgba(0,0,0,0.1); transition: transform 0.3s; } .payoff-img:hover { transform: scale(1.03); }

/* FAQ modal 背景保持覆蓋整個畫面 */
.faq-modal {
    display: none;
    position: fixed; /* 固定於 viewport */
    z-index: 9999;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.6); /* 整個畫面反黑 */ }


/* FAQ modal 內容可靠點擊位置出現 */
.faq-modal-content {
    background: #fff;
    padding: 30px;
    border-radius: 12px;
    max-width: 600px;
    max-height: 80vh;      /* 高度限制，視窗的80% */
    overflow-y: auto;      /* 超過高度出現垂直滾動條 */
    margin: auto;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    position: fixed;  
    text-align: left;
    color: #333;
    font-size: 16px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.15); }




.faq-modal .modal-close {
    position: absolute;
    top: 15px;
    right: 20px;
    color: #333;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}


/* ===================== FAQ Buttons ===================== */ .faq-features {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 20px;
}

.faq-features .feature-item {
    flex: 1 1 28%;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 20px 10px;
    border-radius: 16px;
    background: linear-gradient(145deg,#f9fafc,#e6f0ff);
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s, background 0.3s; } .faq-features .feature-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.18);
    background: linear-gradient(135deg,#dce6ff,#aac6ff);
}

.faq-features .feature-circle {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    font-weight: bold;
    color: white;
    margin-bottom: 12px;
    transition: transform 0.3s, box-shadow 0.3s; } 

    /* FAQ hover 不取消動畫，只控制陰影 */
    .faq-features .feature-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.18); }


.faq1-circle { background: linear-gradient(135deg,#0077cc,#005999);}  /* 藍色系 */
.faq2-circle { background: linear-gradient(135deg,#00a99d,#007a6e);}  /* 青綠色系 */
.faq3-circle { background: linear-gradient(135deg,#ff8c42,#d65a00);}  /* 橘色系 */
.faq4-circle { background: linear-gradient(135deg,#8e44ad,#6c3483);}  /* 紫色系 */
.faq5-circle { background: linear-gradient(135deg,#f39c12,#d68910);}  /* 金黃系 */
.faq6-circle { background: linear-gradient(135deg,#2ecc71,#27ae60);}  /* 綠色系 */


.feature-text {
    font-size: 16px;
    line-height: 1.5;
    font-weight: 500;
    color: #333;
}




/* ===================== Modal ===================== */ .modal {
    display: none;
    position: fixed;
    z-index: 999;
    padding-top: 60px;
    left: 0; top: 0;
    width: 100%; height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.75);
}
.modal-content { margin: auto; display: block; max-width: 90%; border-radius: 12px; } .modal-close { position: absolute; top: 30px; right: 50px; color: #fff; font-size: 36px; font-weight: bold; cursor: pointer; }

</style>
</head>
<body>

<div class="section-wrapper">
<button class="back-btn" onclick="window.location.href='index.html'">←返回主頁</button>

<div class="container">
<h2>🔹 保本 Twinwin</h2>
<p>保本 Twinwin設有上下界，存續期間內若股價從未突破到期時可以依實際漲跌參與收益，且能設定最低收益保障；如果曾經突破過上下界，則到期時不管股票表現如何，投資人收益皆是約定好的KO收益率。結構兼具保本、區間策略及彈性收益特性，適合在盤整震盪區間時選擇。</p>


<h3>🚩 產品特色</h3>
<div class="features">
<div class="feature-item"><div class="feature-circle feature1">💰</div><div class="feature-text">雙向行情皆有收益機會，並有最低保障</div></div>
<div class="feature-item"><div class="feature-circle feature2">☝️</div><div class="feature-text">兼具區間觀點及穩健收益特性</div></div>
<div class="feature-item"><div class="feature-circle feature3">🛡️</div><div class="feature-text">100%保本境外結構型商品</div></div>
</div>

<div class="divider"></div>


<h3>📘 範例商品條件</h3>
<table>
<tr><th>計價幣別</th><td>美元</td></tr>
<tr><th>連結標的</th><td>SPY</td></tr>
<tr><th>天期</th><td>18個月</td></tr>
<tr><th>上界界線 (Upper KO)</th><td>期初價格 x 120%</td></tr>
<tr><th>下界界線 (Lower KO)</th><td>期初價格 x 80%</td></tr>
<tr><th>上下界線觀察頻率 </th><td>每一個工作日觀察一次</td></tr>
<tr><th>KO收益 (KO Rebate)</th><td>3% <span class="tooltip">(flat)<span class="tooltiptext">實質報酬率</span></span></td></tr>
<tr><th>最小收益 (Min Coupon)</th><td>3% <span class="tooltip">(flat)<span class="tooltiptext">實質報酬率</span></span></td></tr>
</table>


<div class="product-info">

  <div class="info-line">
    <strong>💵 KO收益 (KO Rebate)：</strong> 存續期間股價曾經突破上下界線，到期時投資人即領回KO收益 (KO Rebate)
  </div>

  <div class="info-line">
    <strong>⚖️ 上下界界線 (Upper and Lower KO)：</strong> 存續期間股價從來沒有突破過上下界線，則漲跌多少拿多少，最低不小於最小收益 (Min Coupon)

  </div>

  <div class="info-line attention">
    <strong>⚠️ 注意事項：</strong>
    <ul>
      <li>投資人進行提前贖回，仍有可能損失到本金</li>
    </ul>
  </div>

</div>

<style>
.product-info {
  margin-top: 25px;
  font-family: 'Inter', sans-serif;
  font-size: 16px;
  line-height: 1.8;
  color: #333;
}

.info-line {
  border-left: 4px solid #0077cc;
  padding: 12px 16px;
  margin-bottom: 14px;
}

.attention {
  border-left-color: #d35400;
}

.attention ul {
  margin: 6px 0 0 20px;
  padding: 0;
  list-style-type: disc;
}
</style>




<div class="divider"></div>



<h3>📈 情境分析</h3>

<!-- 圖表獨立區塊 -->


<div class="scenario-cards">

<div class="scenario scenarioA" onclick="showScenarioChart('A')">
<div class="scenario-title">A情境</div><div class="scenario-desc">股票價格從來沒有突破過上下界線，最終表現上漲18%</div><div class="scenario-desc">投資人領回: 100%本金 + 18%收益</div></div>

<div class="scenario scenarioB" onclick="showScenarioChart('B')">
<div class="scenario-title">B情境</div><div class="scenario-desc">股票價格從來沒有突破過上下界線，最終表現下跌15%</div><div class="scenario-desc">投資人領回: 100%本金 + 15%收益</div></div>

<div class="scenario scenarioC" onclick="showScenarioChart('C')">
<div class="scenario-title">C情境</div><div class="scenario-desc">股票價格從來沒有突破過上下界線，最終表現跟期初價格比起來沒漲沒跌</div><div class="scenario-desc">投資人領回: 100%本金 + 3%最小收益</div></div>

<div class="scenario scenarioD" onclick="showScenarioChart('D')">
<div class="scenario-title">D情境</div><div class="scenario-desc">股票價格<span style="color:red;">曾經</span>突破過上下界線，到期時不論表現如何都是領回KO收益 (KO Rebate)</div><div class="scenario-desc">投資人領回: 100%本金 + 3%KO收益</div></div>
</div>


<div style="position:relative; max-width:800px; margin:auto; margin-top:20px;">
    <canvas id="scenarioChart" style="width:100%;"></canvas>
    
    <!-- 左側金流標籤 -->
    <div style="position:absolute; bottom:-60px; left:-60px; width:60px; height:60px; display:flex; align-items:center; justify-content:center; font-weight:bold; color:#0077cc; font-size:19px;">金流</div>

    <!-- 金流顯示容器 -->
    <div id="cashFlowOverlay" style="position:absolute; bottom:-60px; left:0; width:100%; height:60px; display:flex; justify-content:space-between; pointer-events:none;">
        <div style="flex:1; margin-left:2px; display:flex; align-items:center; justify-content:center; border:1px solid #0077cc; border-radius:6px; background:#e6f0ff; font-size:14px;">固定配息</div>
        <div style="flex:1; display:flex; align-items:center; justify-content:center; border:1px solid #0077cc; border-radius:6px; background:#e6f0ff; font-size:14px;">固定配息</div>
        <div style="flex:1; display:flex; align-items:center; justify-content:center; border:1px solid #0077cc; border-radius:6px; background:#e6f0ff; font-size:14px;">固定配息</div>
        <div style="flex:1; display:flex; align-items:center; justify-content:center; border:1px solid #0077cc; border-radius:6px; background:#e6f0ff; font-size:14px;">應計配息</div>
        <div style="flex:1; display:flex; align-items:center; justify-content:center; border:1px solid #0077cc; border-radius:6px; background:#e6f0ff; font-size:14px;"> </div>
        <div style="flex:3; display:flex; align-items:center; justify-content:center; border:1px solid #0077cc; border-radius:6px; background:#e6f0ff; font-size:12px;">本金+配息 / 股票+配息</div>
    </div>
</div>




<div class="divider"></div>

<h3>❓ 常見問題</h3>
<div class="faq-features">
    <div class="feature-item" onclick="openFAQ('faq1', event)">
        <div class="feature-circle faq1-circle">Q1</div>
        <div class="feature-text">結構型商品不可交易標的及幣別？</div>
    </div>
    <div class="feature-item" onclick="openFAQ('faq2', event)">
        <div class="feature-circle faq2-circle">Q2</div>
        <div class="feature-text">連結股票若發生合併、併購、國有化、破產或下市怎麼辦？</div>
    </div>
    <div class="feature-item" onclick="openFAQ('faq3', event)">
        <div class="feature-circle faq3-circle">Q3</div>
        <div class="feature-text">連結股票若發生股票分割（Stock Split）怎麼處理？</div>
    </div>
    <div class="feature-item" onclick="openFAQ('faq4', event)">
        <div class="feature-circle faq4-circle">Q4</div>
        <div class="feature-text">境外結構型商品的接股成本如何認列？</div>
    </div>
</div>


<!-- FAQ Modal -->
<div id="faqModal" class="faq-modal">
    <div class="faq-modal-content" id="faqContent"></div>
    <span class="modal-close" onclick="closeFAQ()">&times;</span>
</div>

<script>
// FAQ內容可自行修改

const faqData = {



    faq1: `

<div style="
    margin:25px 0;
    padding:20px 24px;
    border-radius:10px;
    border:1px solid #d3d7df;
    background:#fafbfc;
    box-shadow:0 2px 6px rgba(0,0,0,0.06);
">

    <!-- 標題 -->
    <div style="
        font-size:18px;
        font-weight:700;
        color:#003f7d;
        margin-bottom:12px;
        letter-spacing:0.5px;
    ">
        Q1｜結構型商品不可交易標的及幣別？
    </div>

    <!-- 內容 -->
    <div style="font-size:15px; line-height:1.7; color:#333;">
        
        <div style="margin-bottom:12px;">
            <span style="font-weight:600; color:#c00000;">1. 不得以新臺幣計價</span>
        </div>

        <div style="font-weight:600; margin-bottom:6px;">
            2. 不得連結至下列標的：
        </div>

        <ul style="margin:0 0 14px 20px; padding:0; color:#444; font-size:15px;">
            <li style="margin:6px 0;">新臺幣利率及匯率指標。</li>
            <li style="margin:6px 0;">國內有價證券。</li>
            <li style="margin:6px 0;">國內外機構編製之台股指數及其相關金融商品。</li>
            <li style="margin:6px 0;">
                未經本會核准或申報生效得募集及銷售之境外基金，  
                及未依境外基金管理辦法規定於國內私募之境外基金。
            </li>
        </ul>

        <div style="font-size:13px; color:#777; border-top:1px solid #e5e7eb; padding-top:10px;">
            依《境外結構型商品管理規則》第 17 條規範
        </div>
    </div>
</div>

`,


    faq2: `
<div style="
    border-left:none;
    padding:18px 20px;
    margin:10px 0 20px 0;
">

    <div style="display:flex; align-items:center; margin-bottom:10px;">
        <h2 style="margin:0; font-size:22px; font-weight:700; color:#333;">
            Q2｜連結股票若發生合併、併購、國有化、破產或下市？
        </h2>
    </div>

    <p style="font-size:15px; line-height:1.7;">
        若連結股票發生重大事件（如合併、併購、國有化、破產或下市），發行機構會依專業判斷，
        決定商品是否能繼續存續，或是否需調整條款、提前贖回。
    </p>

    <h3 style="margin:20px 0 8px 0; font-size:18px; color:#4A90E2;">📌 可能的處理方式</h3>

    <p style="font-size:15px; line-height:1.7;">
        <b>① 商品是否能繼續存續</b><br>
        發行機構會先評估事件影響，決定商品是否能維持正常運作。
    </p>

    <p style="font-size:15px; line-height:1.7;">
        <b>② 若能繼續存續 → 可能採取的調整方式：</b><br>
        • 更換「繼任股票」以取代原股票（若於事件後 10 個營業日內無法指定，則採條款調整方式）<br>
        • 調整商品相關要素，例如：到期金額公式、交割方式、利息計算、預期股息、借券成本、波動度或流動性等因素
    </p>

    <p style="font-size:15px; line-height:1.7;">
        <b>③ 若商品無法繼續存續 → 提前贖回</b><br>
        • 會至少提前 5 個營業日通知投資人<br>
        • 給付商品的「提前了結款項」全額
    </p>

    <div style="
        margin-top:20px;
        padding:12px 15px;
        background:#f3f8ff;
        border-radius:8px;
        font-size:15px;
        line-height:1.7;
        color:#0d47a1;
    ">
        <b>📌 重點小結：</b><br>
        股票若發生重大變動 → 可能改股票、改條款或提前贖回，目的在確保商品價值合理與市場實際狀況一致。
    </div>

</div>




`,
    faq3: `

<div style="
    border-left:none;
    padding:18px 20px;
    margin:10px 0 20px 0;
">

    <div style="display:flex; align-items:center; margin-bottom:10px;">
        <h2 style="margin:0; font-size:22px; font-weight:700; color:#333;">
            Q3｜連結股票發生股票分割（Stock Split）時怎麼調整？
        </h2>
    </div>

    <p style="font-size:15px; line-height:1.7;">
        股票分割時，結構型商品的價格門檻會依相同比例自動調整，
        以反映股票面額變化，不影響投資人權益。
    </p>

    <!-- 一般案例 -->
    <h3 style="margin:18px 0 6px 0; font-size:18px; color:#4A90E2;">
        📌 一般案例：如 GOOG 1：20 股票分割
    </h3>

    <p style="font-size:15px; line-height:1.7;">
        以 <b>GOOG（2022/7/18）1：20</b> 股票分割為例：  
        商品的 <b>期初價、KO、Strike、KI</b> 都會「全部除以 20」。  
        <br><b style="color:#0d47a1;">分割後商品照常運作，不會影響投資人權益。</b>
    </p>

    <!-- 特殊案例 -->
    <h3 style="margin:22px 0 6px 0; font-size:18px; color:#4A90E2;">
        📌 特殊情況：如 AMC 配發特別股
    </h3>

    <p style="font-size:15px; line-height:1.7;">
        AMC 在 2022/8/22 發放特別股「APE」，此事件不屬於單純分割，
        因此無法依比例自動調整。
        <br><br>
        <b>由發行機構依專業判斷計算調整因子</b>，以維持商品運作的合理性。
    </p>

    <div style="
        margin-top:20px;
        padding:12px 15px;
        background:#f3f8ff;
        border-radius:8px;
        font-size:15px;
        line-height:1.7;
        color:#0d47a1;
    ">
        <b>📌 小結：</b><br>
        • 一般分割 → 價格自動依比例調整，權益不變。<br>
        • 特殊事件（如 AMC）→ 需由發行機構計算調整因子。
    </div>

</div>


`,


    faq4: `

<div style="
    border-left:none;
    padding:18px 20px;
    margin:10px 0 20px 0;
">

    <div style="display:flex; align-items:center; margin-bottom:10px;">
        <h2 style="margin:0; font-size:22px; font-weight:700; color:#333;">
            Q4｜境外結構型商品的接股成本如何認列？
        </h2>
    </div>

    <p style="font-size:15px; line-height:1.7;">
        境外結構型商品到期若需接股，股票成本與損益認列方式與一般股票投資不同，
        必須依正確的會計與稅務分類處理。
    </p>

    <!-- 股票成本 -->
    <h3 style="margin:18px 0 6px 0; font-size:18px; color:#4A90E2;">
        📌 ① 股票成本怎麼認列？
    </h3>

    <p style="font-size:15px; line-height:1.7;">
        雖然投資人是以 <b>履約價（Strike）</b> 取得股票，但成本認列方式為：
        <br><b>✔ 股票成本 = 最後評價日的收盤價（Fair Market Value）</b><br>
        因此 Strike 與收盤價的差額會直接反映為商品損益。
    </p>

    <!-- 損失 -->
    <h3 style="margin:20px 0 6px 0; font-size:18px; color:#4A90E2;">
        📌 ② 商品損失如何認列？
    </h3>

    <p style="font-size:15px; line-height:1.7;">
        若 Strike 高於最後收盤價，產生的損失會列為：
        <br><b>✔ 境外結構型商品的資本利得損失 →「76-財產交易所得」</b>
    </p>

    <!-- 互抵 -->
    <h3 style="margin:20px 0 6px 0; font-size:18px; color:#4A90E2;">
        📌 ③ FCN 的利息能不能與損失互抵？
    </h3>

    <p style="font-size:15px; line-height:1.7;">
        <b>不能。</b>  
        FCN 利息屬於「海外利息所得」，與上述「財產交易所得」屬於不同類別，稅務上不得互相抵減。
    </p>

    <div style="
        margin-top:20px;
        padding:12px 15px;
        background:#f3f8ff;
        border-radius:8px;
        font-size:15px;
        line-height:1.7;
        color:#0d47a1;
    ">
        <b>📌 小結：</b><br>
        • 股票成本以「最後評價日收盤價」認列。<br>
        • 損失屬於海外財產交易損失。<br>
        • FCN 利息屬「海外利息所得」，不可互抵。
    </div>

</div>


`,
};

function openFAQ(id, event) {
    event.stopPropagation();
    const modal = document.getElementById('faqModal');
    const content = document.getElementById('faqContent');
    content.innerHTML = faqData[id];
    modal.style.display = 'block';

    // 鎖住背景滾動
    document.body.style.overflow = 'hidden'; }

function closeFAQ() {
    document.getElementById('faqModal').style.display = 'none';
    document.body.style.overflow = 'auto'; }


// 點擊 modal 外層關閉
document.getElementById('faqModal').addEventListener('click', function(event) {
    if (event.target === this) {
        this.style.display = 'none';
    }
});


// 點擊空白區域關閉 modal
window.addEventListener('click', function(event){
    const modal = document.getElementById('faqModal');
    if(event.target === modal) modal.style.display = 'none'; });



</script>


<!-- Modal -->
<div id="imgModal" class="modal">
<span class="modal-close" onclick="closeModal()">&times;</span>
<img class="modal-content" id="modalImg"> </div>

<script>
function openModal(src){
    document.getElementById('imgModal').style.display="block";
    document.getElementById('modalImg').src=src;
}
function closeModal(){
    document.getElementById('imgModal').style.display="none";
}

// 點擊 modal 外層關閉
document.getElementById('faqModal').addEventListener('click', function(event) {
    if (event.target === this) {
        closeFAQ(); // 呼叫 closeFAQ() 解鎖滾動
    }
});



</script>


<script>

// -----------------------------
// 參數設定
// -----------------------------
const totalDays = 150; // 六個月 150 天

const strikeLine = 100;

const koLine = 112;

// -----------------------------
// 生成資料
// -----------------------------
const dataA = [100, 90, 85, 110, 95, 90, 118];
const dataB = [100, 110, 90, 85, 105, 90, 85];
const dataC = [100, 105, 93, 83, 90, 110, 100];
const dataD = [100, 105, 93, 75, 88, 100, 120];




// -----------------------------
// Chart.js 初始化
// -----------------------------
const ctx = document.getElementById('scenarioChart').getContext('2d');
let scenarioChart = null;

function showScenarioChart(type){
    if(scenarioChart) scenarioChart.destroy();
    const months = ['期初','3月','6月','9月','12月','15月','18月'];
    let selectedData;
    let cashFlowData;

    switch(type){
        case 'A': 
            selectedData = dataA; 
            cashFlowData = ['','','','','','','本金+18%收益']; 
            break;
        case 'B': 
            selectedData = dataB; 
            cashFlowData = ['','','','','','','本金+15%收益']; 
            break;
        case 'C': 
            selectedData = dataC; 
            cashFlowData = ['','','','','','','本金+3%最小收益']; 
            break;
        case 'D': 
            selectedData = dataD; 
            cashFlowData = ['','','','','','','本金+3%KO收益'];  
            break;
        default: return;
    }

    const scenarioLabelPlugin = {
        id: 'scenarioLabel',
        afterDraw: (chart) => {
            const ctx = chart.ctx;
            ctx.save();
            ctx.font = 'bold 60px Arial';
            ctx.fillStyle = 'rgba(0, 119, 204, 0.2)';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            const x = chart.chartArea.right - 10; 
            const y = (chart.chartArea.top + chart.chartArea.bottom)/2;
            ctx.fillText(type + ' 情境', x, y);
            ctx.restore();
        }
    };

    scenarioChart = new Chart(ctx, {
        type:'line',
        data:{
            labels: months,
            datasets:[
                { label: '股價', data: selectedData, borderColor:'#0077cc', borderWidth:5, fill:false, tension:0.5 },
                { label: '120% 上界界線', data:Array(7).fill(120), borderColor:'#ff0000', borderWidth:2, borderDash:[10,5], fill:false },
                { label: '80% 下界界線', data:Array(7).fill(80), borderColor:'#00aa00', borderWidth:2, borderDash:[10,5], fill:false }
            ]
        },
        options:{
            responsive:true,
            scales:{ y:{ min:70,max:130, title:{ display:true, text:'股價', font:{size:20} } }, x:{ ticks:{ font:{ size:15 } } } },
            plugins:{ legend:{ labels:{ font:{ size:18 } } }, scenarioLabel:{ label:type+' 情境' } }
        },
        plugins:[scenarioLabelPlugin]
    });

    // -------------------------
    // 精準對齊金流
    // -------------------------
    const cashFlowOverlay = document.getElementById('cashFlowOverlay');
    cashFlowOverlay.innerHTML = ''; // 清空

    const xScale = scenarioChart.scales.x;
    cashFlowData.forEach((cf, i) => {
    if (cf === '') return;  // 空字串直接跳過，不生成 div
        const div = document.createElement('div');
        div.style.position = 'absolute';
        div.style.bottom = '0';
        div.style.left = (xScale.getPixelForTick(i) - 40/2-15) + 'px'; // 偏移半寬
        div.style.width = '120px';
        div.style.height = '40px';
        div.style.backgroundColor = '#f9fafc';
        div.style.border = '1px solid #d1d5db';
        div.style.borderRadius = '8px';
        div.style.textAlign = 'center';
        div.style.lineHeight = '40px';
        div.style.fontSize = '14px';
        div.style.color = '#333';
        div.style.boxShadow = '0 2px 6px rgba(0,0,0,0.1)';
        if (cf.includes("股票") || cf.includes("應計配息")) {
    div.innerHTML = `<span style="color:red; font-weight:700;">${cf}</span>`;
} else {
    div.innerHTML = cf;
}
        cashFlowOverlay.appendChild(div);
    });
}




// -----------------------------
// 初始顯示 A 情境
// -----------------------------
showScenarioChart('A');
</script>



</body>
</html>
