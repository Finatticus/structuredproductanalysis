<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<style>
body{font-family:"Segoe UI","Noto Sans TC",Arial,sans-serif;padding:20px;background:#f5f7fa;}
table{border-collapse:collapse;width:100%;}
th,td{border:1px solid #ccc;padding:8px;text-align:left;}
th{background:#0f2a44;color:#fff;}
button{padding:5px 10px;border:none;border-radius:5px;background:#0f2a44;color:#fff;cursor:pointer;}
button:hover{background:#143a5c;}
</style>
</head>
<body>
<h2>帳號管理</h2>
<table>
<thead><tr><th>ID</th><th>帳號</th><th>狀態</th><th>操作</th></tr></thead>
<tbody id="userTable"></tbody>
</table>

<script>
function loadUsers() {
  fetch("/admin/users")
    .then(res=>res.json())
    .then(data=>{
      const tbody=document.getElementById("userTable");
      tbody.innerHTML="";
      data.forEach(user=>{
        const tr=document.createElement("tr");
        tr.innerHTML=`<td>${user.id}</td><td>${user.username}</td><td>${user.status}</td>
        <td>${user.status==='pending'?`<button onclick="approve(${user.id})">批准</button>`:""}</td>`;
        tbody.appendChild(tr);
      });
    });
}

function approve(id) {
  fetch("/admin/approve",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({id})
  })
  .then(res=>res.text())
  .then(msg=>{ alert(msg); loadUsers(); })
  .catch(()=>alert("操作失敗"));
}

loadUsers();
</script>
</body>
</html>
